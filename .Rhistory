mutate_if(is.integer, as.factor)
library(dplyr)
library(ggplot2)
library(GGally)
library(stargazer)
raw = as_tibble(read.csv('crime_v2.csv'))
t = raw %>%
filter(!is.na(county)) %>%
mutate(prbconv = as.numeric(as.character(prbconv)) %>%
mutate_if(is.integer, as.factor)
levels(t$west) = c('East', 'West')
raw = as_tibble(read.csv('crime_v2.csv'))
t = raw %>%
filter(!is.na(county)) %>%
mutate(prbconv = as.numeric(as.character(prbconv)) %>%
mutate_if(is.integer, as.factor)
levels(t$west) = c('East', 'West')
t$west = relevel(t$west, 'West') # Put West first so it appears on the left on facet plots
library(dplyr)
library(ggplot2)
library(GGally)
library(stargazer)
raw = as_tibble(read.csv('crime_v2.csv'))
t = raw %>%
filter(!is.na(county)) %>%
mutate(prbconv = as.numeric(as.character(prbconv)) %>%
mutate_if(is.integer, as.factor)
levels(t$west) = c('East', 'West')
t = raw %>%
filter(!is.na(county)) %>%
mutate(prbconv = as.numeric(as.character(prbconv))) %>%
mutate_if(is.integer, as.factor)
levels(t$west) = c('East', 'West')
t$west = relevel(t$west, 'West') # Put West first so it appears on the left on facet plots
levels(t$central) = c('Outer', 'Central')
levels(t$urban) = c('Non-urban', 'Urban')
t = t %>% mutate(wage = wcon + wtuc + wtrd + wfir + wser + wmfg + wfed + wsta + wloc)
str(t)
t_sub <- subset(t, prbarr <= 1 & prbconv <= 1)
t3 = t_sub %>% select(crmrte, prbarr, prbconv, prbpris, avgsen, polpc, density, taxpc, pctmin80, mix, pctymle, wage)
ggcorr(t3, label = TRUE, label_round = 2, label_size = 3, size = 3) + ggtitle('Correlation Matrix')
summary(t_sub$crmrte)
qplot(t_sub$crmrte, geom = 'histogram', col = I('white'), main = 'Crime Rate', xlab = 'Crime Rate')
summary(t_sub$taxpc)
qplot(t_sub$taxpc, geom = 'histogram', col = I('white'), main = 'Tax Revenue Per Capita', xlab = 'Tax Revenue Per Capita')
summary(t_sub$wage)
summary(t_sub$taxpc)
summary(t_sub$crmrte)
summary(t_sub$taxpc)
summary(t_sub$wage)
summary(t_sub$prbarr)
summary(t_sub$prbconv)
summary(t_sub$prbpris)
summary(t_sub$polpc)
ggplot(t_sub, aes(crmrte, density)) +
geom_point() +
geom_smooth(method = 'lm') +
labs(title = 'Crime Rate vs Population Density', x = 'Crime Rate')
ggplot(t_sub, aes(crmrte, prbarr)) +
geom_point() +
geom_smooth(method = 'lm') +
labs(title = 'Crime Rate vs Probability of Arrest', x = 'Crime Rate')
ggplot(t_sub, aes(crmrte, prbconv)) +
geom_point() +
geom_smooth(method = 'lm') +
labs(title = 'Crime Rate vs Probability of Conviction', x = 'Crime Rate')
model1 = lm(crmrte ~ density, data=t_sub)
model2 = lm(crmrte ~ prbarr, data=t_sub)
model3 = lm(crmrte ~ prbconv, data=t_sub)
stargazer(model1, model2, model3, type = "text")
model_combined = lm(crmrte ~ density + prbarr + prbconv, data=t_sub)
stargazer(model_combined, type = "text")
model1_1 = lm(density ~ wage, data=t_sub)
model1_2 = lm(density ~ taxpc, data=t_sub)
model1_3 = lm(density ~ polpc, data=t_sub)
stargazer(model1_1, model1_2, model1_3, type = "text")
model1_4 = lm(crmrte ~ density + wage + taxpc + polpc, data=t_sub)
stargazer(model1_4, type="text")
model1_5 = lm(crmrte ~ density + taxpc + polpc, data=t_sub)
model1_6 = lm(crmrte ~ density + wage + polpc, data=t_sub)
model1_7 = lm(crmrte ~ density + polpc, data=t_sub)
stargazer(model1_5, model1_6, model1_7, type="text")
model2_1 = lm(prbconv ~ mix, data=t_sub)
stargazer(model2, model2_1, type = "text")
model3_1 = lm(prbarr ~ mix, data=t_sub)
stargazer(model3, model3_1, type = "text")
stargazer(model2_1, type = "text")
stargazer(model3_1, type = "text")
model_combined_1 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix, data=t_sub)
model_combined_1 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix, data=t_sub)
model_combined_2 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv, data=t_sub)
model_combined_3 = lm(crmrte ~ density + polpc + prbarr + prbconv, data=t_sub)
model_combined_4 = lm(crmrte ~ density + polpc + prbarr + prbconv + mix, data=t_sub)
stargazer(model_combined_1, model_combined_2, model_combined_3, model_combined_4, type="text")
model_final_1 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix + wage, data=t_sub)
model_final_2 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix + wage + pctymle, data=t_sub)
model_final_3 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix + wage + pctymle + pctmin80, data=t_sub)
model_final_4 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix + wage + pctymle + pctmin80 + avgsen, data=t_sub)
model_final_5 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix + pctymle + pctmin80 + avgsen, data=t_sub)
stargazer(model_combined_2, model_final_1, model_final_2, model_final_3, model_final_4, model_final_5, type="text")
knitr::opts_chunk$set(echo = TRUE, include = TRUE, warning = FALSE, message = FALSE)
library(dplyr)
library(ggplot2)
library(GGally) # for ggcorr
library(stargazer)
qplot(data$probconv, geom = 'histogram', col = I('white'), main = 'Wages', xlab = 'Wages')
qplot(data$probarr, geom = 'histogram', col = I('white'), main = 'Wages', xlab = 'Wages')
m1 = lm(t$crmrte ~ t$density)
knitr::opts_chunk$set(echo = TRUE, include = TRUE, warning = FALSE, message = FALSE)
library(dplyr)
library(ggplot2)
library(GGally) # for ggcorr
library(stargazer)
raw = as_tibble(read.csv('crime_v2.csv'))
t = raw %>%
filter(!is.na(county)) %>%
mutate(prbconv = as.numeric(as.character(prbconv))) %>%
mutate(pctmin80 = pctmin80 / 100) %>%
mutate_if(is.integer, as.factor) %>%
filter(prbarr < 1 & prbconv < 1)
levels(t$west) = c('East', 'West')
t$west = relevel(t$west, 'West') # Put West first so it appears on the left on facet plots
levels(t$central) = c('Outer', 'Central')
levels(t$urban) = c('Non-urban', 'Urban')
t = t %>% mutate(wage = wcon + wtuc + wtrd + wfir + wser + wmfg + wfed + wsta + wloc)
stargazer(data.frame(t), type = 'text')
qplot(t$crmrte, col = I('white')) +
labs(title = 'Crime Rate', x = 'Crimes Committed per Person')
summary(t$crmrte)
t2 = t %>% select(crmrte, prbarr, prbconv, prbpris, avgsen, polpc, density, taxpc, pctmin80, mix, pctymle, wage)
ggcorr(t2, label = TRUE, label_round = 2, label_size = 3, size = 3) + ggtitle('Correlation Matrix')
qplot(t$density, t$crmrte) +
labs(title = 'Crime Rate vs Population Density', x = 'People per Square Mile',
y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
qplot(t$taxpc, t$crmrte) +
labs(title = 'Crime Rate vs Taxes', x = 'Tax Revenue per Capita', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
qplot(t$wage, t$crmrte) +
labs(title = 'Crime Rate vs Wages', x = 'Weekly Wages', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
qplot(t$polpc, t$crmrte) +
labs(title = 'Crime Rate vs Police Presence', x = 'Police per Capita',
y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
qplot(t$prbarr, t$crmrte) +
labs(title = 'Crime Rate vs Arrest Probability', x = 'Arrest Probability',
y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
qplot(t$prbconv, t$crmrte) +
labs(title = 'Crime Rate vs Conviction Probability', x = 'Conviction Probability', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
m1 = lm(t$crmrte ~ t$density)
m2 = lm(t$crmrte ~ t$density + t$taxpc + t$prbconv)
m3 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$taxpc + t$pctmin80 + t$pctymle)
m4 = lm(t$crmrte ~ t$prbarr + t$prbconv + t$prbpris + t$avgsen + t$density + t$taxpc + t$pctmin80 + t$mix + t$pctymle + t$wage)
stargazer(m1, m2, m3, m4, type = 'text')
qplot(t$crmrte, geom = 'histogram', col = I('white'), main = 'Crime Rate', xlab = 'Crime Rate')
qplot(t$taxpc, geom = 'histogram', col = I('white'), main = 'Tax Revenue Per Capita', xlab = 'Tax Revenue Per Capita')
qplot(t$wage, geom = 'histogram', col = I('white'), main = 'Wages', xlab = 'Wages')
m1 = lm(t$crmrte ~ t$density + t$taxpc + t$prbconv)
m2 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$taxpc + t$pctmin80 + t$pctymle)
m3 = lm(t$crmrte ~ t$prbarr + t$prbconv + t$prbpris + t$avgsen + t$density + t$taxpc + t$pctmin80 + t$mix + t$pctymle + t$wage)
stargazer(m1, m2, m3, type = 'text')
m1 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv)
stargazer(m1, m2, m3, type = 'text')
m1 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv)
stargazer(m1, type = 'text')
m0 = lm(t$crmrte ~ t$density)
m2 = lm(t$crmrte ~ t$prbarr)
m3 = lm(t$crmrte ~ t$prbconv)
m1 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv)
stargazer(m0, m2, m3, m1, type = 'text')
stargazer(m0, m1, m2, m3, type = 'text')
m0 = lm(t$crmrte ~ t$density)
m1 = lm(t$crmrte ~ t$prbarr)
m2 = lm(t$crmrte ~ t$prbconv)
m3 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv)
stargazer(m0, m1, m2, m3, type = 'text')
stargazer(m5, m6, type = 'text')
m5 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$taxpc + t$pctmin80 + t$pctymle)
m6 = lm(t$crmrte ~ t$prbarr + t$prbconv + t$prbpris + t$avgsen + t$density + t$taxpc + t$pctmin80 + t$mix + t$pctymle + t$wage)
stargazer(m5, m6, type = 'text')
m3 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$pctymle)
stargazer(m0, m1, m2, m3, type = 'text')
qplot(t$pctymle, t$crmrte) +
labs(title = 'Crime Rate vs Young Male percentage', x = 'Young Male percentage', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
m3 = lm(t$crmrte ~ t$pctymle)
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$pctymle)
stargazer(m0, m1, m2, m3, m4, type = 'text')
m5 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$pctymle + t$taxpc + t$pctmin80)
m6 = lm(t$crmrte ~ t$prbarr + t$prbconv + t$prbpris + t$avgsen + t$density + t$taxpc + t$pctmin80 + t$mix + t$pctymle + t$wage)
stargazer(m5, m6, type = 'text')
m3 = lm(t$crmrte ~ t$pctmin80)
stargazer(m0, m1, m2, m3, m4, type = 'text')
ymle
m3 = lm(t$crmrte ~ t$pctymle)
stargazer(m0, m1, m2, m3, m4, type = 'text')
m5 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$pctymle + t$pctmin80)
stargazer(m5, m6, type = 'text')
m5 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$pctymle + t$taxpc + t$pctmin80)
m6 = lm(t$crmrte ~ t$prbarr + t$prbconv + t$prbpris + t$avgsen + t$density + t$taxpc + t$pctmin80 + t$mix + t$pctymle + t$wage)
stargazer(m5, m6, type = 'text')
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$taxpc)
stargazer(m0, m1, m2, m3, m4, type = 'text')
m3 = lm(t$crmrte ~ t$taxpc)
stargazer(m0, m1, m2, m3, m4, type = 'text')
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc)
stargazer(m0, m1, m2, m3, m4, type = 'text')
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc + t$pctymle)
stargazer(m0, m1, m2, m3, m4, type = 'text')
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc)
stargazer(m0, m1, m2, m3, m4, type = 'text')
stargazer(m0, m1, m2, m3, type = 'text')
m0 = lm(t$crmrte ~ t$density)
m1 = lm(t$crmrte ~ t$prbarr)
m2 = lm(t$crmrte ~ t$taxpc)
m3 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc)
stargazer(m0, m1, m2, m3, type = 'text')
m3 = lm(t$crmrte ~ t$density + t$prbarr)
stargazer(m0, m1, m2, m3, type = 'text')
m3 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc + t$pctymle)
stargazer(m0, m1, m2, m3, type = 'text')
m1 = lm(t$crmrte ~ t$density)
m2 = lm(t$crmrte ~ t$prbarr)
m3 = lm(t$crmrte ~ t$taxpc)
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc + t$pctymle)
stargazer(m1, m2, m3, m4, type = 'text')
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc)
stargazer(m1, m2, m3, m4, type = 'text')
