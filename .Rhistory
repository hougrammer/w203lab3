geom_point() +
geom_smooth(method = 'lm') +
labs(title = 'Crime Rate vs Probability of Conviction', x = 'Crime Rate')
model1 = lm(crmrte ~ density, data=t_sub)
model2 = lm(crmrte ~ prbarr, data=t_sub)
model3 = lm(crmrte ~ prbconv, data=t_sub)
stargazer(model1, model2, model3, type = "text")
model_combined = lm(crmrte ~ density + prbarr + prbconv, data=t_sub)
stargazer(model_combined, type = "text")
model1_1 = lm(density ~ wage, data=t_sub)
model1_2 = lm(density ~ taxpc, data=t_sub)
model1_3 = lm(density ~ polpc, data=t_sub)
stargazer(model1_1, model1_2, model1_3, type = "text")
model1_4 = lm(crmrte ~ density + wage + taxpc + polpc, data=t_sub)
stargazer(model1_4, type="text")
model1_5 = lm(crmrte ~ density + taxpc + polpc, data=t_sub)
model1_6 = lm(crmrte ~ density + wage + polpc, data=t_sub)
model1_7 = lm(crmrte ~ density + polpc, data=t_sub)
stargazer(model1_5, model1_6, model1_7, type="text")
model2_1 = lm(prbconv ~ mix, data=t_sub)
stargazer(model2, model2_1, type = "text")
model3_1 = lm(prbarr ~ mix, data=t_sub)
stargazer(model3, model3_1, type = "text")
stargazer(model2_1, type = "text")
stargazer(model3_1, type = "text")
model_combined_1 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix, data=t_sub)
model_combined_1 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix, data=t_sub)
model_combined_2 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv, data=t_sub)
model_combined_3 = lm(crmrte ~ density + polpc + prbarr + prbconv, data=t_sub)
model_combined_4 = lm(crmrte ~ density + polpc + prbarr + prbconv + mix, data=t_sub)
stargazer(model_combined_1, model_combined_2, model_combined_3, model_combined_4, type="text")
model_final_1 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix + wage, data=t_sub)
model_final_2 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix + wage + pctymle, data=t_sub)
model_final_3 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix + wage + pctymle + pctmin80, data=t_sub)
model_final_4 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix + wage + pctymle + pctmin80 + avgsen, data=t_sub)
model_final_5 = lm(crmrte ~ density + taxpc + polpc + prbarr + prbconv + mix + pctymle + pctmin80 + avgsen, data=t_sub)
stargazer(model_combined_2, model_final_1, model_final_2, model_final_3, model_final_4, model_final_5, type="text")
knitr::opts_chunk$set(echo = TRUE, include = TRUE, warning = FALSE, message = FALSE)
library(dplyr)
library(ggplot2)
library(GGally) # for ggcorr
library(stargazer)
qplot(data$probconv, geom = 'histogram', col = I('white'), main = 'Wages', xlab = 'Wages')
qplot(data$probarr, geom = 'histogram', col = I('white'), main = 'Wages', xlab = 'Wages')
m1 = lm(t$crmrte ~ t$density)
knitr::opts_chunk$set(echo = TRUE, include = TRUE, warning = FALSE, message = FALSE)
library(dplyr)
library(ggplot2)
library(GGally) # for ggcorr
library(stargazer)
raw = as_tibble(read.csv('crime_v2.csv'))
t = raw %>%
filter(!is.na(county)) %>%
mutate(prbconv = as.numeric(as.character(prbconv))) %>%
mutate(pctmin80 = pctmin80 / 100) %>%
mutate_if(is.integer, as.factor) %>%
filter(prbarr < 1 & prbconv < 1)
levels(t$west) = c('East', 'West')
t$west = relevel(t$west, 'West') # Put West first so it appears on the left on facet plots
levels(t$central) = c('Outer', 'Central')
levels(t$urban) = c('Non-urban', 'Urban')
t = t %>% mutate(wage = wcon + wtuc + wtrd + wfir + wser + wmfg + wfed + wsta + wloc)
stargazer(data.frame(t), type = 'text')
qplot(t$crmrte, col = I('white')) +
labs(title = 'Crime Rate', x = 'Crimes Committed per Person')
summary(t$crmrte)
t2 = t %>% select(crmrte, prbarr, prbconv, prbpris, avgsen, polpc, density, taxpc, pctmin80, mix, pctymle, wage)
ggcorr(t2, label = TRUE, label_round = 2, label_size = 3, size = 3) + ggtitle('Correlation Matrix')
qplot(t$density, t$crmrte) +
labs(title = 'Crime Rate vs Population Density', x = 'People per Square Mile',
y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
qplot(t$taxpc, t$crmrte) +
labs(title = 'Crime Rate vs Taxes', x = 'Tax Revenue per Capita', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
qplot(t$wage, t$crmrte) +
labs(title = 'Crime Rate vs Wages', x = 'Weekly Wages', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
qplot(t$polpc, t$crmrte) +
labs(title = 'Crime Rate vs Police Presence', x = 'Police per Capita',
y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
qplot(t$prbarr, t$crmrte) +
labs(title = 'Crime Rate vs Arrest Probability', x = 'Arrest Probability',
y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
qplot(t$prbconv, t$crmrte) +
labs(title = 'Crime Rate vs Conviction Probability', x = 'Conviction Probability', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
m1 = lm(t$crmrte ~ t$density)
m2 = lm(t$crmrte ~ t$density + t$taxpc + t$prbconv)
m3 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$taxpc + t$pctmin80 + t$pctymle)
m4 = lm(t$crmrte ~ t$prbarr + t$prbconv + t$prbpris + t$avgsen + t$density + t$taxpc + t$pctmin80 + t$mix + t$pctymle + t$wage)
stargazer(m1, m2, m3, m4, type = 'text')
qplot(t$crmrte, geom = 'histogram', col = I('white'), main = 'Crime Rate', xlab = 'Crime Rate')
qplot(t$taxpc, geom = 'histogram', col = I('white'), main = 'Tax Revenue Per Capita', xlab = 'Tax Revenue Per Capita')
qplot(t$wage, geom = 'histogram', col = I('white'), main = 'Wages', xlab = 'Wages')
m1 = lm(t$crmrte ~ t$density + t$taxpc + t$prbconv)
m2 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$taxpc + t$pctmin80 + t$pctymle)
m3 = lm(t$crmrte ~ t$prbarr + t$prbconv + t$prbpris + t$avgsen + t$density + t$taxpc + t$pctmin80 + t$mix + t$pctymle + t$wage)
stargazer(m1, m2, m3, type = 'text')
m1 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv)
stargazer(m1, m2, m3, type = 'text')
m1 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv)
stargazer(m1, type = 'text')
m0 = lm(t$crmrte ~ t$density)
m2 = lm(t$crmrte ~ t$prbarr)
m3 = lm(t$crmrte ~ t$prbconv)
m1 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv)
stargazer(m0, m2, m3, m1, type = 'text')
stargazer(m0, m1, m2, m3, type = 'text')
m0 = lm(t$crmrte ~ t$density)
m1 = lm(t$crmrte ~ t$prbarr)
m2 = lm(t$crmrte ~ t$prbconv)
m3 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv)
stargazer(m0, m1, m2, m3, type = 'text')
stargazer(m5, m6, type = 'text')
m5 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$taxpc + t$pctmin80 + t$pctymle)
m6 = lm(t$crmrte ~ t$prbarr + t$prbconv + t$prbpris + t$avgsen + t$density + t$taxpc + t$pctmin80 + t$mix + t$pctymle + t$wage)
stargazer(m5, m6, type = 'text')
m3 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$pctymle)
stargazer(m0, m1, m2, m3, type = 'text')
qplot(t$pctymle, t$crmrte) +
labs(title = 'Crime Rate vs Young Male percentage', x = 'Young Male percentage', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
m3 = lm(t$crmrte ~ t$pctymle)
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$pctymle)
stargazer(m0, m1, m2, m3, m4, type = 'text')
m5 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$pctymle + t$taxpc + t$pctmin80)
m6 = lm(t$crmrte ~ t$prbarr + t$prbconv + t$prbpris + t$avgsen + t$density + t$taxpc + t$pctmin80 + t$mix + t$pctymle + t$wage)
stargazer(m5, m6, type = 'text')
m3 = lm(t$crmrte ~ t$pctmin80)
stargazer(m0, m1, m2, m3, m4, type = 'text')
ymle
m3 = lm(t$crmrte ~ t$pctymle)
stargazer(m0, m1, m2, m3, m4, type = 'text')
m5 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$pctymle + t$pctmin80)
stargazer(m5, m6, type = 'text')
m5 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$pctymle + t$taxpc + t$pctmin80)
m6 = lm(t$crmrte ~ t$prbarr + t$prbconv + t$prbpris + t$avgsen + t$density + t$taxpc + t$pctmin80 + t$mix + t$pctymle + t$wage)
stargazer(m5, m6, type = 'text')
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$prbconv + t$taxpc)
stargazer(m0, m1, m2, m3, m4, type = 'text')
m3 = lm(t$crmrte ~ t$taxpc)
stargazer(m0, m1, m2, m3, m4, type = 'text')
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc)
stargazer(m0, m1, m2, m3, m4, type = 'text')
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc + t$pctymle)
stargazer(m0, m1, m2, m3, m4, type = 'text')
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc)
stargazer(m0, m1, m2, m3, m4, type = 'text')
stargazer(m0, m1, m2, m3, type = 'text')
m0 = lm(t$crmrte ~ t$density)
m1 = lm(t$crmrte ~ t$prbarr)
m2 = lm(t$crmrte ~ t$taxpc)
m3 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc)
stargazer(m0, m1, m2, m3, type = 'text')
m3 = lm(t$crmrte ~ t$density + t$prbarr)
stargazer(m0, m1, m2, m3, type = 'text')
m3 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc + t$pctymle)
stargazer(m0, m1, m2, m3, type = 'text')
m1 = lm(t$crmrte ~ t$density)
m2 = lm(t$crmrte ~ t$prbarr)
m3 = lm(t$crmrte ~ t$taxpc)
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc + t$pctymle)
stargazer(m1, m2, m3, m4, type = 'text')
m4 = lm(t$crmrte ~ t$density + t$prbarr + t$taxpc)
stargazer(m1, m2, m3, m4, type = 'text')
knitr::opts_chunk$set(echo = TRUE, include = TRUE, warning = FALSE, message = FALSE, dev = 'pdf', fig.height = 4)
library(dplyr)
library(ggplot2)
library(ggfortify) # autoplot
library(dplyr)
library(ggplot2)
library(ggfortify) # autoplot
install.packages("ggfortify")
install.packages("ggfortify")
library(dplyr)
library(ggplot2)
library(ggfortify) # autoplot
library(GGally) # ggcorr
library(ggpubr) # ggarrange
install.packages("ggpubr")
library(dplyr)
library(ggplot2)
library(ggfortify) # autoplot
library(GGally) # ggcorr
library(ggpubr) # ggarrange
library(lmtest)
library(sandwich)
library(stargazer)
stargazer(m1, m2, m3, type = 'latex',
omit.stat = c('f', 'n'),
se = seHC(m1, m2, m3),
star.cutoffs = c(0.05, 0.01, 0.001),
header = FALSE,
float = FALSE,
dep.var.labels = c('Crime Rate'),
title = 'Crime Rate Regressed on Other Variables',
covariate.labels = c('Population Density', 'Arrest Probability', 'Conviction Probability',
'Prison Probability', 'Average Prison Sentence', 'Tax per Capita',
'Percent Minority', 'Offense Mix', 'Percent Young Male',
'Sum of Wages')
)
m1 = lm(t$crmrte ~ t$density + t$prbconv)
knitr::opts_chunk$set(echo = TRUE, include = TRUE, warning = FALSE, message = FALSE, dev = 'pdf', fig.height = 4)
library(dplyr)
library(ggplot2)
library(ggfortify) # autoplot
library(GGally) # ggcorr
library(ggpubr) # ggarrange
library(lmtest)
library(sandwich)
library(stargazer)
raw = as_tibble(read.csv('crime_v2.csv'))
t = raw %>%
filter(!is.na(county)) %>%
mutate(prbconv = as.numeric(as.character(prbconv))) %>%
mutate(pctmin80 = pctmin80 / 100) %>%
mutate_if(is.integer, as.factor) %>%
mutate(badprb = as.factor((prbarr > 1) + (prbconv > 1)))
levels(t$west) = c('East', 'West')
t$west = relevel(t$west, 'West') # Put West first so it appears on the left on facet plots
levels(t$central) = c('Outer', 'Central')
levels(t$urban) = c('Non-urban', 'Urban')
levels(t$badprb) = c('Normal', 'prbconv > 1', 'prbarr > 1 and prbconv > 1')
t2 = t %>%
filter(prbarr < 1 & prbconv < 1)
stargazer(data.frame(t), type = 'latex', nobs = FALSE, header = FALSE, float = FALSE)
qplot(t$crmrte, col = I('white')) +
labs(title = 'Crime Rate', x = 'Crimes Committed per Person')
ggcorr(t %>% select(crmrte, wcon, wtuc, wtrd, wfir, wser, wmfg, wfed, wsta, wloc),
label = TRUE, label_round = 2, label_size = 3, size = 3) +
ggtitle('Correlation Matrix of Crime Rate and Wages')
t = t %>% mutate(wage = wcon + wtuc + wtrd + wfir + wser + wmfg + wfed + wsta + wloc)
t2 = t2 %>% mutate(wage = wcon + wtuc + wtrd + wfir + wser + wmfg + wfed + wsta + wloc)
ggcorr(t %>% select(crmrte, prbarr, prbconv, prbpris, avgsen, polpc, density, taxpc, pctmin80, mix, pctymle, wage),
label = TRUE, label_round = 2, label_size = 3, size = 3) +
ggtitle('Correlation Matrix')
p1 = qplot(t$prbarr, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Arrest Probability', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p2 = qplot(t$prbconv, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Conviction Probability', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p3 = qplot(t$prbpris, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Prison Probability', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p4 = qplot(t$avgsen, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Average Sentence Length', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p5 = qplot(t$polpc, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Police per Capita', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p6 = qplot(t$mix, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Percent Face-to-Face Crime', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
ggarrange(p1, p2, p3, p4, p5, p6, nrow = 3, ncol = 2, common.legend = T)
p7 = qplot(t$density, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Population Density', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p8 = qplot(t$taxpc, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Tax per Capita', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p9 = qplot(t$pctmin80, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Percent Minority (1980)', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p10 = qplot(t$pctymle, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Percent Young Male', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p11 = qplot(t$wage, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Sum of Wages', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
ggarrange(p7, p8, p9, p10, p11, nrow = 3, ncol = 2, common.legend = T)
ggplot(t, aes(crmrte)) +
geom_histogram() +
facet_grid(. ~ urban) +
theme(panel.spacing = unit(2, "lines")) +
labs(title = 'Non-urban vs Urban Crime Rate', x = 'Crime Rate')
ggplot(t, aes(crmrte)) +
geom_histogram() +
facet_grid(west ~ central) +
theme(panel.spacing = unit(1, "lines")) +
labs(title = 'Crime Rate by Region', x = 'Crime Rate')
t.test(t[t$central == 'Outer', ]$crmrte,
t[t$central == 'Central', ]$crmrte)
# function for getting heteroskedasticity robust standard errors
seHC = function(...) {
lapply(list(...), function(x) sqrt(diag(vcovHC(x))))
}
m1_wage = lm(t$crmrte ~ t$wfed)
m2_wage = lm(t$crmrte ~ t$wcon + t$wtuc + t$wtrd + t$wfir + t$wser + t$wmfg + t$wfed + t$wsta + t$wloc)
m3_wage = lm(t$crmrte ~ t$wage)
stargazer(m1_wage, m2_wage, m3_wage, type = 'latex',
omit.stat = c('f', 'n'),
se = seHC(m1_wage, m2_wage, m3_wage),
star.cutoffs = c(0.05, 0.01, 0.001),
dep.var.labels = c('Crime Rate'),
header = FALSE,
float = FALSE,
title = 'Crime Rate Regressed on Wage Variables',
covariate.labels = c('Construction', 'Trans, Util, Commun', 'Whlesle, Retail, Trade',
'Fin, Ins, Real Est', 'Service', 'Manuacturing', 'Federal', 'State',
'Local', 'Total Sum')
)
m1 = lm(t$crmrte ~ t$density + t$prbconv)
m2 = lm(t$crmrte ~ t$density + t$prbconv + t$taxpc + t$pctmin80 + t$pctymle)
m3 = lm(t$crmrte ~ t$prbarr + t$prbconv + t$prbpris + t$avgsen + t$density + t$taxpc + t$pctmin80 + t$mix + t$pctymle + t$wage)
stargazer(m1, m2, m3, type = 'latex',
omit.stat = c('f', 'n'),
se = seHC(m1, m2, m3),
star.cutoffs = c(0.05, 0.01, 0.001),
header = FALSE,
float = FALSE,
dep.var.labels = c('Crime Rate'),
title = 'Crime Rate Regressed on Other Variables',
covariate.labels = c('Population Density', 'Arrest Probability', 'Conviction Probability',
'Prison Probability', 'Average Prison Sentence', 'Tax per Capita',
'Percent Minority', 'Offense Mix', 'Percent Young Male',
'Sum of Wages')
)
m2 = lm(t$crmrte ~ t$density + t$prbconv + t$taxpc + t$pctmin80 + t$pctymle)
stargazer(m1, m2, m3, type = 'latex',
omit.stat = c('f', 'n'),
se = seHC(m1, m2, m3),
star.cutoffs = c(0.05, 0.01, 0.001),
header = FALSE,
float = FALSE,
dep.var.labels = c('Crime Rate'),
title = 'Crime Rate Regressed on Other Variables',
covariate.labels = c('Population Density', 'Arrest Probability', 'Conviction Probability',
'Prison Probability', 'Average Prison Sentence', 'Tax per Capita',
'Percent Minority', 'Offense Mix', 'Percent Young Male',
'Sum of Wages')
)
m2 = lm(t$crmrte ~ t$density + t$prbconv + t$taxpc + t$pctmin80 + t$pctymle)
m4 = lm(log(t$crmrte) ~ t$density + t$prbconv + t$taxpc + t$pctmin80 + t$pctymle)
m5 = lm(log(t$crmrte) ~ log(t$density) + log(t$prbconv) + log(t$taxpc) + log(t$pctmin80) + log(t$pctymle))
stargazer(m2, m4, m5, type = 'latex',
omit.stat = c('f', 'n'),
se = seHC(m1, m2, m3),
star.cutoffs = c(0.05, 0.01, 0.001),
header = FALSE,
float = FALSE,
dep.var.labels = c('Crime Rate'),
title = 'Crime Rate Regressed on Other Variables'
)
stargazer(m2, m4, m5, type = 'latex',
omit.stat = c('f', 'n'),
se = seHC(m2, m4, m5),
star.cutoffs = c(0.05, 0.01, 0.001),
header = FALSE,
float = FALSE,
dep.var.labels = c('Crime Rate'),
title = 'Crime Rate Regressed on Other Variables',
covariate.labels = c('Population Density', 'Conviction Probability',
'Tax per Capita', 'Percent Minority', 'Percent Young Male')
)
plot(mode2, which = 1)
plot(mode2, which = 1)
plot(model2, which = 1)
plot(model2, which = 1)
knitr::opts_chunk$set(echo = TRUE, include = TRUE, warning = FALSE, message = FALSE, dev = 'pdf', fig.height = 4)
library(dplyr)
library(ggplot2)
library(ggfortify) # autoplot
library(GGally) # ggcorr
library(ggpubr) # ggarrange
library(lmtest)
library(sandwich)
library(stargazer)
raw = as_tibble(read.csv('crime_v2.csv'))
t = raw %>%
filter(!is.na(county)) %>%
mutate(prbconv = as.numeric(as.character(prbconv))) %>%
mutate(pctmin80 = pctmin80 / 100) %>%
mutate_if(is.integer, as.factor) %>%
mutate(badprb = as.factor((prbarr > 1) + (prbconv > 1)))
levels(t$west) = c('East', 'West')
t$west = relevel(t$west, 'West') # Put West first so it appears on the left on facet plots
levels(t$central) = c('Outer', 'Central')
levels(t$urban) = c('Non-urban', 'Urban')
levels(t$badprb) = c('Normal', 'prbconv > 1', 'prbarr > 1 and prbconv > 1')
t2 = t %>%
filter(prbarr < 1 & prbconv < 1)
stargazer(data.frame(t), type = 'latex', nobs = FALSE, header = FALSE, float = FALSE)
qplot(t$crmrte, col = I('white')) +
labs(title = 'Crime Rate', x = 'Crimes Committed per Person')
ggcorr(t %>% select(crmrte, wcon, wtuc, wtrd, wfir, wser, wmfg, wfed, wsta, wloc),
label = TRUE, label_round = 2, label_size = 3, size = 3) +
ggtitle('Correlation Matrix of Crime Rate and Wages')
t = t %>% mutate(wage = wcon + wtuc + wtrd + wfir + wser + wmfg + wfed + wsta + wloc)
t2 = t2 %>% mutate(wage = wcon + wtuc + wtrd + wfir + wser + wmfg + wfed + wsta + wloc)
ggcorr(t %>% select(crmrte, prbarr, prbconv, prbpris, avgsen, polpc, density, taxpc, pctmin80, mix, pctymle, wage),
label = TRUE, label_round = 2, label_size = 3, size = 3) +
ggtitle('Correlation Matrix')
p1 = qplot(t$prbarr, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Arrest Probability', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p2 = qplot(t$prbconv, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Conviction Probability', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p3 = qplot(t$prbpris, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Prison Probability', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p4 = qplot(t$avgsen, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Average Sentence Length', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p5 = qplot(t$polpc, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Police per Capita', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p6 = qplot(t$mix, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Percent Face-to-Face Crime', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
ggarrange(p1, p2, p3, p4, p5, p6, nrow = 3, ncol = 2, common.legend = T)
p7 = qplot(t$density, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Population Density', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p8 = qplot(t$taxpc, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Tax per Capita', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p9 = qplot(t$pctmin80, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Percent Minority (1980)', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p10 = qplot(t$pctymle, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Percent Young Male', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
p11 = qplot(t$wage, t$crmrte, col = t$badprb) +
labs(title = NULL, col = NULL, x = 'Sum of Wages', y = 'Crimes Committed per Person') +
geom_smooth(method = 'lm', se = FALSE)
ggarrange(p7, p8, p9, p10, p11, nrow = 3, ncol = 2, common.legend = T)
ggplot(t, aes(crmrte)) +
geom_histogram() +
facet_grid(. ~ urban) +
theme(panel.spacing = unit(2, "lines")) +
labs(title = 'Non-urban vs Urban Crime Rate', x = 'Crime Rate')
ggplot(t, aes(crmrte)) +
geom_histogram() +
facet_grid(west ~ central) +
theme(panel.spacing = unit(1, "lines")) +
labs(title = 'Crime Rate by Region', x = 'Crime Rate')
t.test(t[t$central == 'Outer', ]$crmrte,
t[t$central == 'Central', ]$crmrte)
# function for getting heteroskedasticity robust standard errors
seHC = function(...) {
lapply(list(...), function(x) sqrt(diag(vcovHC(x))))
}
m1_wage = lm(t$crmrte ~ t$wfed)
m2_wage = lm(t$crmrte ~ t$wcon + t$wtuc + t$wtrd + t$wfir + t$wser + t$wmfg + t$wfed + t$wsta + t$wloc)
m3_wage = lm(t$crmrte ~ t$wage)
stargazer(m1_wage, m2_wage, m3_wage, type = 'latex',
omit.stat = c('f', 'n'),
se = seHC(m1_wage, m2_wage, m3_wage),
star.cutoffs = c(0.05, 0.01, 0.001),
dep.var.labels = c('Crime Rate'),
header = FALSE,
float = FALSE,
title = 'Crime Rate Regressed on Wage Variables',
covariate.labels = c('Construction', 'Trans, Util, Commun', 'Whlesle, Retail, Trade',
'Fin, Ins, Real Est', 'Service', 'Manuacturing', 'Federal', 'State',
'Local', 'Total Sum')
)
m1 = lm(t$crmrte ~ t$density + t$prbconv)
m2 = lm(t$crmrte ~ t$density + t$prbconv + t$prbarr + t$pctmin80 + t$pctymle + t$taxpc)
m3 = lm(t$crmrte ~ t$density + t$prbconv + t$prbarr + t$pctmin80 + t$pctymle + t$taxpc + t$prbpris + t$avgsen + t$mix + t$wage)
stargazer(m1, m2, m3, type = 'latex',
omit.stat = c('f', 'n'),
se = seHC(m1, m2, m3),
star.cutoffs = c(0.05, 0.01, 0.001),
header = FALSE,
float = FALSE,
dep.var.labels = c('Crime Rate'),
title = 'Crime Rate Regressed on Other Variables',
covariate.labels = c('Population Density', 'Conviction Probability', 'Arrest Probability',
'Percent Minority', 'Percent Young Male', 'Tax per Capita',
'Prison Probability', 'Average Prison Sentence', 'Offense Mix',
'Sum of Wages')
)
m4 = lm(log(t$crmrte) ~ t$density + t$prbconv + t$taxpc + t$pctmin80 + t$pctymle)
m5 = lm(log(t$crmrte) ~ log(t$density) + log(t$prbconv) + log(t$taxpc) + log(t$pctmin80) + log(t$pctymle))
stargazer(m2, m4, m5, type = 'latex',
omit.stat = c('f', 'n'),
se = seHC(m2, m4, m5),
star.cutoffs = c(0.05, 0.01, 0.001),
header = FALSE,
float = FALSE,
covariate.labels = c('Population Density', 'Conviction Probability',
'Tax per Capita', 'Percent Minority', 'Percent Young Male')
)
plot(model2, which = 1)
plot(model2, which = 1)
plot(m2, which = 1)
plot(m3, which = 1)
plot(m4, which = 1)
plot(m5, which = 1)
plot(m2, which = 1)
plot(m2, which = 3)
plot(m4, which = 3)
plot(m2, which = 3)
plot(m4, which = 3)
plot(m2, which = 2)
plot(m4, which = 2)
plot(m4, which = 1)
plot(m3, which = 1)
plot(m5, which = 1)
plot(m5, which = 3)
4
plot(m4, which = 3)
plot(m2, which = 1)
plot(m4, which = 1)
stargazer(m2, m4, m5, type = 'text',
se = seHC(m2, m4, m5))
